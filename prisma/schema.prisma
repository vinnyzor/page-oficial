generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "postgresql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model contas {
  id   Int    @id @default(autoincrement())
  nome String @db.VarChar(100)
}

model financas {
  id           Int       @id @default(autoincrement())
  telefone     String    @db.VarChar(20)
  nome_financa String    @db.VarChar(255)
  tipo_financa String    @db.VarChar(10)
  data_hora    DateTime? @default(now()) @db.Timestamp(6)
  valor        Decimal   @db.Decimal(10, 2)
  conta_id     Int
}

model payments {
  id              Int      @id @default(autoincrement())
  userId          Int
  email           String
  telefone        String?  @db.VarChar(20)
  status          String   @default("pending")
  session_id      String   @unique
  amount          Decimal  @db.Decimal(10, 2)
  currency        String   @default("USD") @db.VarChar(3)
  created_at      DateTime @default(now())
  price_id        String?  @db.VarChar(100)
  product_id      String?  @db.VarChar(100)
  subscription_id String?
}

model planos {
  id                Int      @id @default(autoincrement())
  user_id           Int
  conta_id          Int
  payments_id       Int?     @unique
  inicio            DateTime
  fim               DateTime
  periodo_pagamento String   @db.VarChar(20)
  plano_price_id    Int
}

model planos_prices {
  id       Int     @id @default(autoincrement())
  nome     String
  periodo  String
  price_id String
  valor    Decimal @db.Decimal(10, 2)
}

model user_contas {
  user_id  Int
  conta_id Int

  @@id([user_id, conta_id])
}

model users {
  id         Int      @id @default(autoincrement())
  email      String   @unique
  telefone   String?  @db.VarChar(20)
  created_at DateTime @default(now())
  nome       String   @db.VarChar(25)
}


model Lead {
  id          String   @id @default(uuid())
  whatsapp    String
  plano       String   // ex: 'duo', 'individual'
  periodo     String   // 'mensal' | 'anual'
  origem      String   // ex: 'checkout-modal', 'landing', 'form-topo'
  url         String   // URL de onde o lead foi gerado
  createdAt   DateTime @default(now())
}
